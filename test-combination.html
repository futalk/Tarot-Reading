<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»„åˆè§£è¯»æµ‹è¯•</title>
    <style>
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 30px;
            border-radius: 15px;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
        }
        .test-result {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .test-result h3 {
            color: #ffd89b;
            margin-bottom: 15px;
        }
        .test-result pre {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        button {
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
            margin: 10px;
        }
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 215, 155, 0.4);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”® å¡”ç½—ç‰Œç»„åˆè§£è¯»ç³»ç»Ÿæµ‹è¯•</h1>
        
        <div style="text-align: center; margin-bottom: 30px;">
            <button onclick="testTriangle()">æµ‹è¯•ä¸‰è§’ç‰Œé˜µ</button>
            <button onclick="testCeltic()">æµ‹è¯•å‡¯å°”ç‰¹åå­—</button>
            <button onclick="testSpecialCombos()">æµ‹è¯•ç‰¹æ®Šç»„åˆ</button>
        </div>
        
        <div id="results"></div>
    </div>

    <script type="module">
        import { detectPatterns, weaveStory } from './js/utils/tarot-combinations.js';
        import { tarotCards } from './js/data/tarot-cards.js';

        // æ ¹æ®åç§°æŸ¥æ‰¾ç‰Œ
        function findCard(name) {
            return tarotCards.find(card => card.name === name);
        }

        // æµ‹è¯•ä¸‰è§’ç‰Œé˜µ
        window.testTriangle = function() {
            const cards = [
                findCard('æ„šè€…'),
                findCard('é­”æœ¯å¸ˆ'),
                findCard('å¤ªé˜³')
            ];
            const orientations = [false, false, false];
            
            runTest('ä¸‰è§’ç‰Œé˜µæµ‹è¯•ï¼ˆè¿‡å»-ç°åœ¨-æœªæ¥ï¼‰', cards, orientations, 'triangle');
        };

        // æµ‹è¯•å‡¯å°”ç‰¹åå­—
        window.testCeltic = function() {
            const cards = [
                findCard('æ‹äºº'),
                findCard('æ¶é­”'),
                findCard('æ­»ç¥'),
                findCard('é«˜å¡”'),
                findCard('æ˜Ÿæ˜Ÿ'),
                findCard('å¤ªé˜³'),
                findCard('åŠ›é‡'),
                findCard('æˆ˜è½¦'),
                findCard('æœˆäº®'),
                findCard('ä¸–ç•Œ')
            ];
            const orientations = [false, false, false, false, false, false, false, false, false, false];
            
            runTest('å‡¯å°”ç‰¹åå­—ç‰Œé˜µæµ‹è¯•', cards, orientations, 'celtic');
        };

        // æµ‹è¯•ç‰¹æ®Šç»„åˆ
        window.testSpecialCombos = function() {
            const cards = [
                findCard('æ­»ç¥'),
                findCard('å¤ªé˜³'),
                findCard('å®¡åˆ¤')
            ];
            const orientations = [false, false, false];
            
            runTest('ç‰¹æ®Šç»„åˆæµ‹è¯•ï¼ˆæ­»ç¥-å¤ªé˜³-å®¡åˆ¤ï¼‰', cards, orientations, 'triangle');
        };

        // è¿è¡Œæµ‹è¯•
        function runTest(testName, cards, orientations, spread) {
            const resultsDiv = document.getElementById('results');
            
            // æ£€æµ‹æ¨¡å¼
            const patterns = detectPatterns(cards, orientations);
            
            // ç¼–ç»‡æ•…äº‹
            const story = weaveStory(cards, orientations, spread, patterns);
            
            // æ˜¾ç¤ºç»“æœ
            const resultHTML = `
                <div class="test-result">
                    <h3>${testName}</h3>
                    <p><strong>æŠ½å–çš„ç‰Œï¼š</strong>${cards.map(c => c.name).join('ã€')}</p>
                    
                    <h4>ğŸ“Š æ¨¡å¼åˆ†æ</h4>
                    <pre>${JSON.stringify(patterns, null, 2)}</pre>
                    
                    <h4>ğŸ“– æ•…äº‹ç¼–ç»‡</h4>
                    <div style="background: rgba(255, 255, 255, 0.05); padding: 15px; border-radius: 8px;">
                        <p><strong>å¼€ç¯‡ï¼š</strong>${story.opening}</p>
                        
                        ${story.development && story.development.length > 0 ? `
                            <p><strong>å‘å±•ï¼š</strong></p>
                            <ul>
                                ${story.development.map(d => `<li>${d.message || JSON.stringify(d)}</li>`).join('')}
                            </ul>
                        ` : ''}
                        
                        <p><strong>é«˜æ½®ï¼š</strong>${story.climax}</p>
                        <p><strong>ç»“å±€ï¼š</strong>${story.resolution}</p>
                        
                        <div style="margin-top: 15px; padding: 15px; background: rgba(138, 43, 226, 0.2); border-radius: 8px;">
                            ${story.deepInsight.split('\n').map(line => line.trim() ? `<p>${line}</p>` : '').join('')}
                        </div>
                        
                        ${story.actionSteps && story.actionSteps.length > 0 ? `
                            <p><strong>ğŸ’¡ è¡ŒåŠ¨å»ºè®®ï¼š</strong></p>
                            <ul>
                                ${story.actionSteps.map(step => `<li>[${step.priority}] ${step.action}</li>`).join('')}
                            </ul>
                        ` : ''}
                    </div>
                </div>
            `;
            
            resultsDiv.innerHTML = resultHTML + resultsDiv.innerHTML;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
        document.getElementById('results').innerHTML = `
            <div class="test-result">
                <h3>æ¬¢è¿ä½¿ç”¨ç»„åˆè§£è¯»æµ‹è¯•å·¥å…·</h3>
                <p>ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æµ‹è¯•ä¸åŒçš„ç‰Œé˜µç»„åˆï¼ŒæŸ¥çœ‹æ·±åº¦è§£è¯»æ•ˆæœã€‚</p>
                <p>æœ¬æµ‹è¯•å·¥å…·ç”¨äºéªŒè¯ï¼š</p>
                <ul>
                    <li>âœ… ç‰Œç»„åˆæ¨¡å¼è¯†åˆ«ï¼ˆå¤§é˜¿å°”å¡çº³ã€èŠ±è‰²ã€æ•°å­—ç­‰ï¼‰</li>
                    <li>âœ… ç‰Œä¸ç‰Œä¹‹é—´çš„å…³ç³»åˆ†æï¼ˆç‰¹æ®Šç»„åˆã€åºåˆ—ã€å¯¹ç«‹ç­‰ï¼‰</li>
                    <li>âœ… æ•…äº‹ç¼–ç»‡ç®—æ³•ï¼ˆå¼€ç¯‡ã€å‘å±•ã€é«˜æ½®ã€ç»“å±€ï¼‰</li>
                    <li>âœ… æ·±å±‚æ´å¯Ÿç”Ÿæˆï¼ˆçµé­‚è¯¾é¢˜ã€å¿ƒç†æ¨¡å¼ã€èƒ½é‡å¹³è¡¡ï¼‰</li>
                    <li>âœ… è¡ŒåŠ¨å»ºè®®ç”Ÿæˆï¼ˆç«‹å³è¡ŒåŠ¨ã€æŒç»­å…³æ³¨ã€é•¿æœŸç›®æ ‡ï¼‰</li>
                </ul>
            </div>
        `;
    </script>
</body>
</html>
