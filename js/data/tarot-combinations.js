/**
 * 塔罗牌组合数据库
 * 定义常见的2-3张牌组合及其特殊含义
 * 
 * 数据结构说明：
 * - key: 牌名组合，用'+'连接，按字母顺序排列
 * - meaning: 组合的特殊含义
 * - context: 适用的情境（可选）
 * - advice: 针对组合的特别建议
 */

export const tarotCombinations = {
    // ==================== 大阿尔卡纳重要组合 ====================
    
    // 新开始与显化
    '愚者+魔术师': {
        meaning: '纯粹的创造潜能即将显化。这是将天真的梦想转化为实际行动的完美时机，宇宙正在支持你的新开始。',
        theme: '创造显化',
        advice: '不要只是计划，立即采取第一步行动。你拥有所需的一切资源，相信自己的能力。',
        context: ['事业', '创业', '新项目']
    },
    
    // 直觉与智慧
    '女祭司+隐士': {
        meaning: '深刻的内在智慧正在觉醒。这个组合强调独处和内省的重要性，真理将在寂静中显现。',
        theme: '内在智慧',
        advice: '暂时远离外界的喧嚣，深入你的内心世界。答案已经在你心中，只需要安静地倾听。',
        context: ['灵性成长', '自我探索', '重大决策']
    },
    
    // 丰盛与稳定
    '皇后+皇帝': {
        meaning: '阴阳平衡，创造与结构的完美结合。这个组合预示着稳定的丰盛和持久的成功。',
        theme: '平衡创造',
        advice: '在滋养和纪律之间找到平衡。既要有创造力，也要有执行力；既要温柔，也要坚定。',
        context: ['家庭', '事业', '长期规划']
    },
    
    // 精神指引
    '教皇+隐士': {
        meaning: '寻找精神导师或成为他人的导师。传统智慧与个人洞见的结合将带来深刻的理解。',
        theme: '精神导师',
        advice: '向有经验的人学习，同时也要信任自己的内在指引。真正的智慧来自两者的融合。',
        context: ['学习', '灵性', '导师关系']
    },
    
    // 选择与行动
    '恋人+战车': {
        meaning: '在做出重要选择后，坚定地朝目标前进。价值观的一致性将推动你克服所有障碍。',
        theme: '坚定选择',
        advice: '一旦做出符合内心的选择，就全力以赴。不要回头，不要怀疑，勇往直前。',
        context: ['关系', '职业选择', '人生方向']
    },
    
    // 内在力量
    '力量+隐士': {
        meaning: '通过独处和内省培养真正的内在力量。温柔而坚定的自我掌控将带来深刻的转变。',
        theme: '内在修炼',
        advice: '在安静中培养你的内在力量。真正的勇气不是对抗，而是温柔地驯服内心的野兽。',
        context: ['自我成长', '情绪管理', '克服恐惧']
    },
    
    // 命运转折
    '命运之轮+审判': {
        meaning: '重大的命运转折点，过去的业力正在结算。这是重生和新周期开始的时刻。',
        theme: '命运转折',
        advice: '接受生命的转变，这是你应得的新开始。放下过去，拥抱即将到来的新周期。',
        context: ['人生转折', '业力清算', '重大改变']
    },
    
    // 公正与平衡
    '正义+节制': {
        meaning: '完美的平衡和公正的结果。耐心和中庸之道将带来应得的回报。',
        theme: '平衡正义',
        advice: '保持耐心和公正，宇宙的天平正在调整。所有的付出都会得到公平的回报。',
        context: ['法律事务', '公平交易', '因果平衡']
    },
    
    // 深度转变
    '死神+高塔': {
        meaning: '彻底的转变和重生。旧的结构必须完全崩塌，才能为新生腾出空间。',
        theme: '彻底转变',
        advice: '不要抗拒这个必要的结束。虽然痛苦，但这是通往真正重生的唯一道路。',
        context: ['重大转变', '结束与开始', '危机转机']
    },
    
    // 希望与成功
    '星星+太阳': {
        meaning: '希望实现，成功在望。这是最积极的组合之一，预示着光明的未来和纯粹的喜悦。',
        theme: '希望成真',
        advice: '相信你的梦想，它们正在实现。保持乐观和开放，美好的事情正在发生。',
        context: ['愿望实现', '康复', '新开始']
    },
    
    // 幻觉与真相
    '月亮+太阳': {
        meaning: '从迷雾中走向清晰，真相即将揭示。黑暗之后必有光明。',
        theme: '真相揭示',
        advice: '你正在走出困惑和恐惧。继续前进，光明就在前方，真相即将显现。',
        context: ['走出困惑', '真相揭示', '克服恐惧']
    },
    
    // 完成与新开始
    '世界+愚者': {
        meaning: '一个周期的完美结束和新周期的开始。带着智慧和经验开始新的旅程。',
        theme: '周期循环',
        advice: '庆祝你的成就，同时准备好新的冒险。你已经完成了一个重要的学习周期。',
        context: ['毕业', '完成项目', '新阶段']
    },
    
    // ==================== 权杖组合（行动与激情）====================
    
    '权杖王牌+权杖三': {
        meaning: '新的创意项目正在扩张。初始的灵感火花正在发展成为具体的计划和机会。',
        theme: '创意扩张',
        advice: '抓住这个创造性的动能，积极寻找合作伙伴和资源来扩大你的愿景。',
        context: ['创业', '项目启动', '创意工作']
    },
    
    '权杖王牌+魔术师': {
        meaning: '创造力的完美显化。你拥有将想法转化为现实的所有工具和能量。',
        theme: '创造显化',
        advice: '现在是采取行动的最佳时机。你的创造力和执行力都处于巅峰状态。',
        context: ['新项目', '创业', '艺术创作']
    },
    
    '权杖六+权杖十': {
        meaning: '成功带来的重担。虽然获得了认可，但也承担了过多的责任。',
        theme: '成功压力',
        advice: '学会委派和分享责任。成功不应该以健康和幸福为代价。',
        context: ['职业成功', '领导压力', '工作平衡']
    },
    
    // ==================== 圣杯组合（情感与关系）====================
    
    '圣杯王牌+圣杯二': {
        meaning: '新的爱情或深厚友谊的开始。纯粹的情感连接正在形成。',
        theme: '新的连接',
        advice: '打开你的心，真诚地与他人连接。这是建立深厚关系的完美时机。',
        context: ['新恋情', '友谊', '伙伴关系']
    },
    
    '圣杯王牌+恋人': {
        meaning: '真爱降临或重要的情感选择。心灵的连接与价值观的一致。',
        theme: '真爱选择',
        advice: '跟随你的心，但也要确保价值观的一致。真正的爱是心灵和灵魂的共鸣。',
        context: ['爱情', '重要选择', '灵魂伴侣']
    },
    
    '圣杯四+圣杯八': {
        meaning: '对现状的不满促使你寻找更深的意义。是时候离开舒适区了。',
        theme: '寻找意义',
        advice: '不要忽视内心的不满。它是在告诉你需要寻找更有意义的东西。',
        context: ['人生转变', '寻找目标', '精神追求']
    },
    
    '圣杯十+皇后': {
        meaning: '家庭的幸福和情感的圆满。爱与滋养创造了完美的和谐。',
        theme: '家庭幸福',
        advice: '珍惜并培养你的家庭关系。这是真正的财富和幸福的源泉。',
        context: ['家庭', '亲子关系', '情感满足']
    },
    
    // ==================== 宝剑组合（思维与真相）====================
    
    '宝剑王牌+正义': {
        meaning: '真相和正义将会胜利。清晰的思维和公正的判断带来正确的结果。',
        theme: '真相正义',
        advice: '坚持真相和原则。公正的结果即将到来，诚实将得到回报。',
        context: ['法律', '公正', '真相揭示']
    },
    
    '宝剑二+恋人': {
        meaning: '艰难的情感选择。需要在两个同样重要的选项之间做出决定。',
        theme: '艰难抉择',
        advice: '不要逃避这个决定。深入你的内心，倾听真正的价值观，然后勇敢选择。',
        context: ['关系选择', '两难困境', '重要决策']
    },
    
    '宝剑三+宝剑十': {
        meaning: '深刻的心痛和痛苦的结束。这是最困难的时期，但也是疗愈的开始。',
        theme: '深度疗愈',
        advice: '允许自己充分悲伤。这个痛苦虽然深刻，但它会带来最终的疗愈和释放。',
        context: ['失恋', '背叛', '深度创伤']
    },
    
    '宝剑六+星星': {
        meaning: '从困境中走向希望。虽然仍在过渡中，但前方有光明在等待。',
        theme: '走向希望',
        advice: '继续前进，不要回头。你正在离开动荡，走向平静和希望。',
        context: ['走出困境', '疗愈旅程', '新希望']
    },
    
    // ==================== 星币组合（物质与实际）====================
    
    '星币王牌+星币三': {
        meaning: '新的工作或项目将通过团队合作获得成功。技能和努力得到认可。',
        theme: '合作成功',
        advice: '投资于你的技能发展，与他人合作。你的努力将得到实际的回报。',
        context: ['新工作', '项目合作', '技能发展']
    },
    
    '星币王牌+皇帝': {
        meaning: '稳固的物质基础和长期的成功。结构化的方法带来持久的繁荣。',
        theme: '稳固基础',
        advice: '建立坚实的基础，制定长期计划。稳定和成功需要结构和纪律。',
        context: ['事业', '财务规划', '长期投资']
    },
    
    '星币四+星币九': {
        meaning: '从控制到自给自足的转变。学会在安全和享受之间找到平衡。',
        theme: '平衡享受',
        advice: '不要过度控制或囤积。真正的安全来自内心，学会享受你创造的丰盛。',
        context: ['财务', '安全感', '生活质量']
    },
    
    '星币十+世界': {
        meaning: '物质和精神的完美圆满。家族传承和个人成就的完美结合。',
        theme: '圆满成就',
        advice: '庆祝你的成就，同时准备传承你的智慧和财富。这是完整的成功。',
        context: ['事业成功', '家族传承', '人生圆满']
    },
    
    // ==================== 跨元素组合 ====================
    
    '权杖王牌+圣杯王牌': {
        meaning: '激情与爱的完美结合。创造性的能量与情感的丰盛同时到来。',
        theme: '激情之爱',
        advice: '这是创造和爱的黄金时期。让你的激情和情感自由流动。',
        context: ['创意', '爱情', '灵感']
    },
    
    '权杖王牌+宝剑王牌': {
        meaning: '清晰的愿景与强大的行动力。思想和行动的完美统一。',
        theme: '思行合一',
        advice: '你的想法清晰，行动力强大。这是实现突破的最佳时机。',
        context: ['突破', '创新', '领导']
    },
    
    '权杖王牌+星币王牌': {
        meaning: '创意与实际的完美结合。灵感将转化为实际的物质成功。',
        theme: '创意变现',
        advice: '将你的创意转化为实际的项目。现在是创业或启动新项目的好时机。',
        context: ['创业', '项目启动', '创意变现']
    },
    
    '圣杯王牌+宝剑王牌': {
        meaning: '情感的清晰和真相的揭示。心与脑的完美平衡。',
        theme: '情理平衡',
        advice: '在情感和理性之间找到平衡。真相和爱可以共存。',
        context: ['关系', '沟通', '真诚表达']
    },
    
    '圣杯王牌+星币王牌': {
        meaning: '情感的满足与物质的丰盛。内在和外在的双重祝福。',
        theme: '双重丰盛',
        advice: '享受这个情感和物质都丰盛的时期。感恩并分享你的祝福。',
        context: ['全面丰盛', '幸福', '成功']
    },
    
    '宝剑王牌+星币王牌': {
        meaning: '清晰的思维带来实际的成功。智慧的决策创造物质的繁荣。',
        theme: '智慧成功',
        advice: '用你的智慧做出明智的决策。清晰的思维将带来实际的回报。',
        context: ['商业', '投资', '战略规划']
    },
    
    // ==================== 宫廷牌组合 ====================
    
    '权杖国王+星币国王': {
        meaning: '愿景与执行的完美结合。领导力和商业智慧创造持久的成功。',
        theme: '领导成功',
        advice: '结合你的愿景和实际能力。你有能力创造持久的影响和成功。',
        context: ['领导', '商业', '长期成功']
    },
    
    '圣杯王后+宝剑王后': {
        meaning: '情感智慧与理性判断的平衡。同理心和清晰思维的完美结合。',
        theme: '智慧同理',
        advice: '在保持同理心的同时，也要保持清晰的界限和判断。',
        context: ['关系', '咨询', '帮助他人']
    },
    
    // ==================== 三张牌特殊组合 ====================
    
    '愚者+魔术师+世界': {
        meaning: '完整的创造周期。从纯真的开始，通过显化的过程，到达圆满的完成。',
        theme: '完整周期',
        advice: '你正在经历一个完整的创造周期。信任这个过程，每个阶段都有其意义。',
        context: ['人生旅程', '项目周期', '成长过程']
    },
    
    '女祭司+力量+星星': {
        meaning: '内在智慧、温柔力量和希望的三重祝福。深刻的疗愈和灵性成长。',
        theme: '灵性疗愈',
        advice: '信任你的直觉，用温柔的力量面对挑战，保持希望。疗愈正在发生。',
        context: ['疗愈', '灵性成长', '内在力量']
    },
    
    '战车+力量+星星': {
        meaning: '决心、勇气和希望的完美结合。你有能力克服任何障碍。',
        theme: '克服障碍',
        advice: '保持决心，用温柔的力量前进，相信美好的未来。你会成功的。',
        context: ['克服困难', '实现目标', '坚持梦想']
    }
};

/**
 * 获取牌组合的特殊含义
 * @param {Array<string>} cards - 牌名数组
 * @returns {Object|null} 组合含义对象或null
 */
export function getCombinationMeaning(cards) {
    if (!cards || cards.length < 2) return null;
    
    // 按字母顺序排序牌名
    const sortedCards = [...cards].sort();
    const key = sortedCards.join('+');
    
    return tarotCombinations[key] || null;
}

/**
 * 查找包含特定牌的所有组合
 * @param {string} cardName - 牌名
 * @returns {Array<Object>} 包含该牌的所有组合
 */
export function findCombinationsWithCard(cardName) {
    const results = [];
    
    for (const [key, value] of Object.entries(tarotCombinations)) {
        if (key.includes(cardName)) {
            results.push({
                cards: key.split('+'),
                ...value
            });
        }
    }
    
    return results;
}

/**
 * 根据情境筛选相关组合
 * @param {string} context - 情境类型
 * @returns {Array<Object>} 相关组合列表
 */
export function getCombinationsByContext(context) {
    const results = [];
    
    for (const [key, value] of Object.entries(tarotCombinations)) {
        if (value.context && value.context.includes(context)) {
            results.push({
                cards: key.split('+'),
                ...value
            });
        }
    }
    
    return results;
}
